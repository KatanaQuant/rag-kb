# Release v2.1.5-beta

**Date**: 2025-12-03
**Type**: Beta Pre-release
**Breaking Changes**: Yes (Major version bump from v1.x)

---

## Summary

Major version bump due to breaking changes. Continues from v1.10.5 development.

### Breaking Changes

1. **Directory rename**: `knowledge_base/` â†’ `kb/`
2. **MCP stdio removed**: Only HTTP transport supported

---

## Migration Guide

### From v1.9.1 (Last Stable Release)

#### 1. Rename Knowledge Base Directory

```bash
# Stop services
docker-compose down

# Rename directory
mv knowledge_base kb

# If using custom path in .env, update variable name
# OLD: KNOWLEDGE_BASE_PATH=/path/to/docs
# NEW: KB_PATH=/path/to/docs
```

#### 2. Remove MCP stdio (if used)

```bash
# Remove old stdio MCP server
claude mcp remove rag-kb-stdio

# Add HTTP transport
claude mcp add --transport http --scope user rag-kb http://localhost:8000/mcp
```

#### 3. Update and Rebuild

```bash
git fetch --tags
git checkout v2.1.5-beta
docker-compose build --no-cache
docker-compose up -d
```

---

## Changes Since v1.9.1

### Breaking

- `knowledge_base/` directory renamed to `kb/`
- `KNOWLEDGE_BASE_PATH` env var renamed to `KB_PATH` (old name still works)
- MCP stdio transport removed (use HTTP transport)

### Added

- Pre-queue validation system (validates before queuing)
- Pipeline architecture refactoring
- Debug logging for malware detection cache
- Debug logging for pipeline rejection tracking
- Domain model documentation (`docs/domain/`) - glossary, bounded contexts, aggregates

### Changed

- **License**: Changed from Unlicense to CC BY-NC 4.0 (non-commercial use only)

### Improved

- Test skip messages include paths for debugging
- Chunk timing logs now realistic

### Fixed

- Pipeline coordinator responsibilities clarified
- Malware detection cache silent failures now logged

---

## Compatibility

| Component | v1.9.1 | v2.1.5-beta |
|-----------|--------|-------------|
| Knowledge base dir | `knowledge_base/` | `kb/` |
| Env variable | `KNOWLEDGE_BASE_PATH` | `KB_PATH` |
| MCP transport | HTTP + stdio | HTTP only |
| Database schema | Unchanged | Unchanged |
| API endpoints | Unchanged | Unchanged |

---

## Testing

This beta has passed:
- Unit tests (888 passing)
- E2E filetype tests (.py, .go, .ipynb, .pdf)
- EPUB conversion test
- EICAR malware detection test
- No errors in logs

Report issues at: https://github.com/KatanaQuant/rag-kb/issues
