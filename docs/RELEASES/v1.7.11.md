# v1.7.11: Performance, Quality, and Architecture Release

**Release Date**: 2025-11-28

## Summary

Major performance and quality release with batch encoding (10-50x throughput), pipeline reliability fixes, improved chunking for Jupyter/Obsidian, and JavaScript/TSX support.

---

## Highlights

### Performance
- **Batch encoding** - 10-50x throughput improvement for large documents
- **70% CPU resource profile** - Optimized defaults (EMBEDDING_WORKERS=2, BATCH_SIZE=32)

### Chunking Quality
- **Jupyter notebooks** - Unified HybridChunker approach (84% coherence, was 17.5%)
- **Obsidian markdown** - Switched to HybridChunker (fixes 252K+ char oversized chunks)
- **Quality metrics** - New evaluation module with boundary coherence and retrieval accuracy metrics

### Language Support
- **JavaScript/TSX/JSX** - Now supported via TreeSitterChunker

### Pipeline Reliability
- **Queue deduplication** - Fixed race condition where files could be processed twice
- **Pre-stage skip check** - Already-indexed files filtered before entering queue
- **Post-indexing orphan check** - Catches orphans created during initial indexing

### Code Quality
- **Reduced complexity** - Simplified security and malware detection modules
- **Improved architecture** - Better separation of concerns in startup lifecycle

---

## Changes by Category

### New Features
- Chunking quality metrics framework (`api/evaluation/`)
- Baseline report generation for coherence analysis

### Bug Fixes
- Queue dedup race condition (files removed from tracking too early)
- Obsidian oversized chunks (SemanticChunker didn't split long lines)
- JavaScript/TSX/JSX extraction failure ("Unsupported Programming Language")
- EPUB conversion logging (was showing misleading "0 chunks extracted")
- EPUB PDF placement when EPUB already in original/ directory
- File watcher missing .go extension support
- File move UNIQUE constraint failure (destination path already exists)

### Removed
- Plain text (.txt) file support - use markdown format instead
- Legacy Jupyter cell-by-cell chunking approach

---

## Test Coverage

- 735 tests passing
- E2E validation: 1639 documents, 49916 chunks

---

## Configuration

Default settings (optimized for CPU):
```yaml
EMBEDDING_WORKERS=2      # Concurrent embedding threads
CHUNK_WORKERS=2          # Concurrent chunking threads
EMBEDDING_BATCH_SIZE=32  # Chunks per model.encode() call
```

---

## Upgrade Notes

No breaking changes. Standard upgrade process:

```bash
docker-compose down
git fetch --tags && git checkout v1.7.11
docker-compose build --no-cache
docker-compose up -d
```

Your data (`data/rag.db`, `knowledge_base/`) persists across updates.

---

## Full Changelog

Changes since v1.6.7:
- Batch encoding with BatchEncoder class
- Pipeline queue fixes (deduplication, pre-stage skip, mark_complete callback)
- Obsidian HybridChunker migration
- Jupyter unified chunking approach
- JavaScript/TSX/JSX TreeSitter support
- Chunking quality evaluation framework
- Code complexity reduction
- Documentation improvements
